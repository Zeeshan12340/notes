# Malware Basics
Malware in PDFs/files:
----------------------

[https://googleprojectzero.blogspot.com/2021/12/a-deep-dive-into-nso-zero-click.html](https://googleprojectzero.blogspot.com/2021/12/a-deep-dive-into-nso-zero-click.html) 

This includes:

*   Javascript
*   Python
*   Executables
*   Powershell Shellcode

`peepdf` to begin a precursory analysis of a PDF file to determine the presence of Javascript. If there is, we will extract this Javascript code (without executing it) for our inspection.

![](Malware%20Basics/image.png)

Confirms JS, for extracting 

1.  `echo 'extract js > javascript-from-demo_notsuspicious.pdf' > extracted_javascript.txt`
2.  `peepdf -s extracted_javascript.txt demo_notsuspicious.pdf`

Pdfs can have attachments for zips/images but they can also be other pdfs/malware

Office Docs/VBA scripts
-----------------------

We can simply use REMnux's `vmonkey` which is a parser engine that is capable of analysing visual basic macros without executing (opening the document).

`vmonkey DefinitelyALegitInvoice.doc`

Packer's use an executable as a source and output's it to another executable. This executable will have had some modifications made depending on the packer. For example, the new executable could be compressed and/or obfuscated by using mathematics.

![](Malware%20Basics/1_image.png)

When an executable is packed, it must unpack itself before any code can execute. Because of this, packers change the entry point from the original location to what's called the "Unpacking Stub".

![](Malware%20Basics/2_image.png)